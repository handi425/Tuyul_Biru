<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TUYUL BIRU V2.0 - Dokumentasi Lengkap</title>
    <style>
        :root {
            --primary: #0096ff;
            --secondary: #00d4aa;
            --bg-dark: #0a0a0f;
            --bg-card: #12141a;
            --bg-code: #1a1d24;
            --text: #e0e0e0;
            --text-muted: #888;
            --border: #2a2d35;
            --success: #00ff88;
            --warning: #ffaa00;
            --danger: #ff4466;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            line-height: 1.6;
        }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        header {
            background: linear-gradient(135deg, #0a1628 0%, #1a0a28 100%);
            border-bottom: 3px solid var(--primary);
            padding: 40px 20px;
            text-align: center;
        }
        header h1 {
            font-size: 3em;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        header .version { color: var(--warning); font-size: 1.2em; }
        header .tagline { color: var(--text-muted); margin-top: 10px; }
        nav {
            background: var(--bg-card);
            padding: 15px;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border);
        }
        nav ul { list-style: none; display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; }
        nav a {
            color: var(--text);
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 5px;
            background: var(--bg-code);
            transition: all 0.3s;
        }
        nav a:hover { background: var(--primary); color: #fff; }
        section { margin: 40px 0; }
        h2 {
            color: var(--primary);
            border-left: 4px solid var(--primary);
            padding-left: 15px;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        h3 { color: var(--secondary); margin: 20px 0 10px; }
        h4 { color: var(--warning); margin: 15px 0 8px; }
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid var(--border);
        }
        th { background: var(--bg-code); color: var(--primary); }
        tr:hover { background: rgba(0,150,255,0.05); }
        code {
            background: var(--bg-code);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            color: var(--secondary);
        }
        pre {
            background: var(--bg-code);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            border-left: 3px solid var(--primary);
        }
        .tag {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            margin: 2px;
        }
        .tag-buy { background: rgba(0,255,136,0.2); color: var(--success); }
        .tag-sell { background: rgba(255,68,102,0.2); color: var(--danger); }
        .tag-info { background: rgba(0,150,255,0.2); color: var(--primary); }
        .tag-warn { background: rgba(255,170,0,0.2); color: var(--warning); }
        .icon { font-size: 1.5em; margin-right: 10px; }
        .flex { display: flex; align-items: center; gap: 10px; }
        .highlight { background: linear-gradient(90deg, rgba(0,150,255,0.1), transparent); padding: 10px; border-radius: 5px; }
        ul, ol { margin-left: 25px; margin-bottom: 15px; }
        li { margin: 8px 0; }
        .toc { columns: 2; column-gap: 30px; }
        @media (max-width: 768px) {
            header h1 { font-size: 2em; }
            .grid { grid-template-columns: 1fr; }
            .toc { columns: 1; }
        }
    </style>
</head>
<body>

<header>
    <h1>‚óÜ TUYUL BIRU V2.0 ‚óÜ</h1>
    <div class="version">Version 2.00 | Manual Trading Panel with HTF Signals</div>
    <div class="tagline">Expert Advisor untuk MetaTrader 5 dengan Panel Trading Manual, Signal Generator, dan News Filter</div>
</header>

<nav>
    <ul>
        <li><a href="#overview">üìã Overview</a></li>
        <li><a href="#parameters">‚öôÔ∏è Parameters</a></li>
        <li><a href="#structures">üì¶ Structures</a></li>
        <li><a href="#indicators">üìä Indicators</a></li>
        <li><a href="#panel">üñ•Ô∏è Panel UI</a></li>
        <li><a href="#trading">üíπ Trading</a></li>
        <li><a href="#signals">üì° Signals</a></li>
        <li><a href="#snr">üìç S/R Levels</a></li>
        <li><a href="#divergence">üîÄ Divergence</a></li>
        <li><a href="#news">üì∞ News Filter</a></li>
        <li><a href="#functions">üîß Functions</a></li>
    </ul>
</nav>

<div class="container">

<!-- OVERVIEW -->
<section id="overview">
    <h2>üìã Overview</h2>
    <div class="card">
        <p><strong>TUYUL BIRU V2.0</strong> adalah Expert Advisor (EA) untuk MetaTrader 5 yang menyediakan panel trading manual dengan fitur-fitur canggih:</p>
        <ul>
            <li>üñ•Ô∏è <strong>Panel Trading Manual</strong> - Tombol Buy/Sell dengan opsi Grid dan Martingale</li>
            <li>üìä <strong>Multi-Timeframe Signals</strong> - Monitor RSI, SnR, dan Divergence di 5 timeframe (M15, M30, H1, H4, D1)</li>
            <li>üìà <strong>Trend MA Visualization</strong> - Garis MA dengan warna dinamis berdasarkan trend</li>
            <li>üì° <strong>Signal Generator</strong> - Scoring system untuk menghasilkan sinyal Buy/Sell</li>
            <li>üì∞ <strong>News Filter</strong> - Deteksi dan tampilan berita ekonomi dari MQL5 Calendar</li>
            <li>üîÄ <strong>RSI Divergence Detection</strong> - Deteksi divergence bullish/bearish</li>
        </ul>
    </div>
    
    <div class="card">
        <h3>Informasi Teknis</h3>
        <table>
            <tr><th>Property</th><th>Value</th></tr>
            <tr><td>Copyright</td><td>TUYUL BIRU</td></tr>
            <tr><td>Version</td><td>2.00</td></tr>
            <tr><td>Magic Number</td><td><code>666777</code></td></tr>
            <tr><td>Order Filling</td><td>ORDER_FILLING_IOC</td></tr>
            <tr><td>Slippage</td><td>30 points</td></tr>
            <tr><td>Include Files</td><td><code>Trade\Trade.mqh</code></td></tr>
        </table>
    </div>
</section>

<!-- INPUT PARAMETERS -->
<section id="parameters">
    <h2>‚öôÔ∏è Input Parameters</h2>
    
    <div class="card">
        <h3>üîî HTF Signal Settings</h3>
        <table>
            <tr><th>Parameter</th><th>Type</th><th>Default</th><th>Deskripsi</th></tr>
            <tr><td><code>HTF_Timeframe</code></td><td>ENUM_TIMEFRAMES</td><td>PERIOD_H1</td><td>Timeframe untuk sinyal HTF</td></tr>
            <tr><td><code>RSI_Period</code></td><td>int</td><td>14</td><td>Periode RSI</td></tr>
            <tr><td><code>RSI_Overbought</code></td><td>int</td><td>70</td><td>Level overbought RSI</td></tr>
            <tr><td><code>RSI_Oversold</code></td><td>int</td><td>30</td><td>Level oversold RSI</td></tr>
            <tr><td><code>RSI_Div_Lookback</code></td><td>int</td><td>30</td><td>Lookback untuk deteksi divergence</td></tr>
            <tr><td><code>InpDrawDivLines</code></td><td>bool</td><td>true</td><td>Gambar garis divergence</td></tr>
            <tr><td><code>InpDivBullColor</code></td><td>color</td><td>clrLime</td><td>Warna divergence bullish</td></tr>
            <tr><td><code>InpDivBearColor</code></td><td>color</td><td>clrRed</td><td>Warna divergence bearish</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>üìç SnR Settings</h3>
        <table>
            <tr><th>Parameter</th><th>Type</th><th>Default</th><th>Deskripsi</th></tr>
            <tr><td><code>SnR_Pivot_Period</code></td><td>int</td><td>10</td><td>Periode pivot (bars kiri/kanan)</td></tr>
            <tr><td><code>SnR_Max_Levels</code></td><td>int</td><td>10</td><td>Maksimal level S/R</td></tr>
            <tr><td><code>SnR_Proximity</code></td><td>double</td><td>50</td><td>Jarak proximity ke S/R (points)</td></tr>
            <tr><td><code>SnR_Look_Back</code></td><td>int</td><td>500</td><td>Lookback untuk pencarian pivot</td></tr>
            <tr><td><code>SnR_Support_Color</code></td><td>color</td><td>clrLime</td><td>Warna garis support</td></tr>
            <tr><td><code>SnR_Resistance_Color</code></td><td>color</td><td>clrRed</td><td>Warna garis resistance</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>üì• Entry Settings</h3>
        <table>
            <tr><th>Parameter</th><th>Type</th><th>Default</th><th>Deskripsi</th></tr>
            <tr><td><code>InpDefaultLot</code></td><td>double</td><td>0.01</td><td>Ukuran lot default</td></tr>
            <tr><td><code>InpLotIncrement</code></td><td>double</td><td>0.01</td><td>Increment lot untuk martingale</td></tr>
            <tr><td><code>InpGridStep</code></td><td>int</td><td>200</td><td>Jarak grid default (points)</td></tr>
            <tr><td><code>InpGridLayers</code></td><td>int</td><td>5</td><td>Jumlah layer grid</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>üõ°Ô∏è Risk & Management</h3>
        <table>
            <tr><th>Parameter</th><th>Type</th><th>Default</th><th>Deskripsi</th></tr>
            <tr><td><code>InpSLTPMode</code></td><td>ENUM_SLTP_MODE</td><td>SLTP_MODE_AUTO_ATR_SNR</td><td>Mode SL/TP</td></tr>
            <tr><td><code>InpFixedSL</code></td><td>int</td><td>500</td><td>Fixed SL (Points)</td></tr>
            <tr><td><code>InpFixedTP</code></td><td>int</td><td>1000</td><td>Fixed TP (Points)</td></tr>
            <tr><td><code>InpATR_Period</code></td><td>int</td><td>14</td><td>Periode ATR untuk SL</td></tr>
            <tr><td><code>InpATR_Multiplier</code></td><td>double</td><td>1.5</td><td>Multiplier ATR untuk SL</td></tr>
            <tr><td><code>InpPartialPercent</code></td><td>double</td><td>50.0</td><td>Persentase partial close</td></tr>
            <tr><td><code>InpBE_Lock</code></td><td>int</td><td>50</td><td>Lock profit Break Even (Points)</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>üìà Trend MA Settings</h3>
        <table>
            <tr><th>Parameter</th><th>Type</th><th>Default</th><th>Deskripsi</th></tr>
            <tr><td><code>InpShowTrendMA</code></td><td>bool</td><td>true</td><td>Tampilkan garis Trend MA</td></tr>
            <tr><td><code>InpTrendMA_Slow</code></td><td>int</td><td>200</td><td>Periode MA lambat</td></tr>
            <tr><td><code>InpTrendMA_Fast</code></td><td>int</td><td>10</td><td>Periode MA cepat</td></tr>
            <tr><td><code>InpTrendBullColor</code></td><td>color</td><td>clrLime</td><td>Warna trend bullish</td></tr>
            <tr><td><code>InpTrendBearColor</code></td><td>color</td><td>clrRed</td><td>Warna trend bearish</td></tr>
            <tr><td><code>InpTrendMA_Width</code></td><td>int</td><td>2</td><td>Ketebalan garis MA</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>üì° Signal Generator Settings</h3>
        <table>
            <tr><th>Parameter</th><th>Type</th><th>Default</th><th>Deskripsi</th></tr>
            <tr><td><code>InpEnableSignal</code></td><td>bool</td><td>true</td><td>Aktifkan Signal Generator</td></tr>
            <tr><td><code>InpADX_Period</code></td><td>int</td><td>14</td><td>Periode ADX</td></tr>
            <tr><td><code>InpADX_Level</code></td><td>int</td><td>20</td><td>Level minimum ADX</td></tr>
            <tr><td><code>InpRSI_NearLevel</code></td><td>int</td><td>5</td><td>Toleransi RSI near OB/OS</td></tr>
            <tr><td><code>InpShowSignalArrow</code></td><td>bool</td><td>true</td><td>Tampilkan panah sinyal</td></tr>
            <tr><td><code>InpSignalAlert</code></td><td>bool</td><td>true</td><td>Aktifkan alert sinyal</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>üì∞ News Filter Settings</h3>
        <table>
            <tr><th>Parameter</th><th>Type</th><th>Default</th><th>Deskripsi</th></tr>
            <tr><td><code>InpEnableNews</code></td><td>bool</td><td>true</td><td>Aktifkan deteksi berita</td></tr>
            <tr><td><code>InpNewsAlert</code></td><td>bool</td><td>true</td><td>Alert sebelum berita high impact</td></tr>
            <tr><td><code>InpNewsAlertMinutes</code></td><td>int</td><td>30</td><td>Menit sebelum berita untuk alert</td></tr>
            <tr><td><code>InpNewsLookAhead</code></td><td>int</td><td>24</td><td>Jam look ahead</td></tr>
            <tr><td><code>InpNewsLookBack</code></td><td>int</td><td>2</td><td>Jam look back (berita terbaru)</td></tr>
            <tr><td><code>InpShowLowImpact</code></td><td>bool</td><td>false</td><td>Tampilkan berita low impact</td></tr>
            <tr><td><code>InpShowMediumImpact</code></td><td>bool</td><td>true</td><td>Tampilkan berita medium impact</td></tr>
            <tr><td><code>InpShowHighImpact</code></td><td>bool</td><td>true</td><td>Tampilkan berita high impact</td></tr>
            <tr><td><code>InpNewsHighColor</code></td><td>color</td><td>clrRed</td><td>Warna high impact</td></tr>
            <tr><td><code>InpNewsMediumColor</code></td><td>color</td><td>clrOrange</td><td>Warna medium impact</td></tr>
            <tr><td><code>InpNewsLowColor</code></td><td>color</td><td>clrYellow</td><td>Warna low impact</td></tr>
        </table>
    </div>
</section>

<!-- STRUCTURES -->
<section id="structures">
    <h2>üì¶ Data Structures</h2>
    
    <div class="grid">
        <div class="card">
            <h3>ENUM_SLTP_MODE</h3>
            <p>Mode penghitungan SL/TP:</p>
            <ul>
                <li><code>SLTP_MODE_FIXED</code> - Fixed Points</li>
                <li><code>SLTP_MODE_AUTO_ATR_SNR</code> - SL=ATR, TP=SnR</li>
                <li><code>SLTP_MODE_MARTINGALE</code> - Reserved</li>
            </ul>
        </div>
        
        <div class="card">
            <h3>ENUM_NEWS_IMPACT</h3>
            <p>Level dampak berita:</p>
            <ul>
                <li><code>NEWS_IMPACT_NONE</code> = 0</li>
                <li><code>NEWS_IMPACT_LOW</code> = 1 üü°</li>
                <li><code>NEWS_IMPACT_MEDIUM</code> = 2 üü†</li>
                <li><code>NEWS_IMPACT_HIGH</code> = 3 üî¥</li>
            </ul>
        </div>

        <div class="card">
            <h3>SnRData</h3>
            <p>Struktur data Support/Resistance:</p>
            <pre>struct SnRData {
    double pivots[];      // Array pivot points
    double levels[];      // Calculated S/R levels
    ENUM_TIMEFRAMES tf;   // Timeframe
    datetime lastBar;     // Last processed bar
    string name;          // TF name (M15/M30/etc)
};</pre>
        </div>

        <div class="card">
            <h3>SignalConditions</h3>
            <p>Struktur kondisi sinyal:</p>
            <pre>struct SignalConditions {
    bool maCrossUp;       // MA10 cross above MA200
    bool maCrossDown;     // MA10 cross below MA200
    bool trendChanged;    // Trend color changed
    bool adxBullish;      // DI+ > DI-
    bool adxBearish;      // DI- > DI+
    bool adxStrong;       // ADX > level
    bool diCrossUp;       // DI+ crossed above DI-
    bool diCrossDown;     // DI- crossed above DI+
    bool atSupport;       // Price at support
    bool atResistance;    // Price at resistance
    bool breakSupport;    // Price broke support
    bool breakResistance; // Price broke resistance
    bool rsiOversold;     // RSI <= 30 or near
    bool rsiOverbought;   // RSI >= 70 or near
    bool bullishEngulf;   // Bullish engulfing
    bool bearishEngulf;   // Bearish engulfing
    bool atSwingHigh;     // At recent high
    bool atSwingLow;      // At recent low
};</pre>
        </div>

        <div class="card">
            <h3>RSIPivotData</h3>
            <p>Data pivot RSI untuk divergence:</p>
            <pre>struct RSIPivotData {
    int bar;          // Bar index
    datetime time;    // Time
    double price;     // Price value
    double rsi;       // RSI value
    bool isHigh;      // Is pivot high?
};</pre>
        </div>

        <div class="card">
            <h3>NewsEvent</h3>
            <p>Data event berita ekonomi:</p>
            <pre>struct NewsEvent {
    datetime time;           // Event time
    string currency;         // Currency (USD, EUR, etc)
    string name;             // Event name
    ENUM_NEWS_IMPACT impact; // Impact level
    string actual;           // Actual value
    string forecast;         // Forecast value
    string previous;         // Previous value
    bool isPast;             // Already passed?
};</pre>
        </div>
    </div>
</section>

<!-- INDICATORS -->
<section id="indicators">
    <h2>üìä Indicator Handles</h2>
    
    <div class="card">
        <h3>RSI Handles (Multi-Timeframe)</h3>
        <table>
            <tr><th>Handle</th><th>Timeframe</th><th>Deskripsi</th></tr>
            <tr><td><code>hRSI_M15</code></td><td>M15</td><td>RSI untuk timeframe M15</td></tr>
            <tr><td><code>hRSI_M30</code></td><td>M30</td><td>RSI untuk timeframe M30</td></tr>
            <tr><td><code>hRSI_H1</code></td><td>H1</td><td>RSI untuk timeframe H1</td></tr>
            <tr><td><code>hRSI_H4</code></td><td>H4</td><td>RSI untuk timeframe H4</td></tr>
            <tr><td><code>hRSI_D1</code></td><td>D1</td><td>RSI untuk timeframe D1</td></tr>
            <tr><td><code>hRSI_Current</code></td><td>Current</td><td>RSI untuk signal generator</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>Trend MA Handles</h3>
        <table>
            <tr><th>Handle</th><th>Type</th><th>Period</th><th>Price</th></tr>
            <tr><td><code>hMA200_HLC</code></td><td>EMA</td><td>200</td><td>PRICE_TYPICAL (HLC/3)</td></tr>
            <tr><td><code>hMA10_HLC</code></td><td>EMA</td><td>10</td><td>PRICE_TYPICAL (HLC/3)</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>Other Indicators</h3>
        <table>
            <tr><th>Handle</th><th>Indicator</th><th>Usage</th></tr>
            <tr><td><code>hATR</code></td><td>ATR</td><td>Untuk kalkulasi SL dinamis</td></tr>
            <tr><td><code>hADX</code></td><td>ADX</td><td>Signal generator - trend strength & DI+/DI-</td></tr>
        </table>
    </div>
</section>

<!-- PANEL UI -->
<section id="panel">
    <h2>üñ•Ô∏è Trading Panel UI</h2>
    
    <div class="card">
        <h3>Layout 4-Column</h3>
        <p>Panel menggunakan layout 4 kolom dengan posisi di pojok kiri bawah chart:</p>
        
        <table>
            <tr><th>Col 0</th><th>Col 1</th><th>Col 2</th><th>Col 3</th></tr>
            <tr><td class="tag tag-info">Del Pending</td><td class="tag tag-sell">CLOSE ALL</td><td>Reset SL/TP</td><td>Break Even</td></tr>
            <tr><td class="tag tag-buy">Close BUY</td><td class="tag tag-sell">Close SELL</td><td>Apply SL</td><td>Apply TP</td></tr>
            <tr><td>BUY MART</td><td>SELL MART</td><td>Partial Profit</td><td>Partial Loss</td></tr>
            <tr><td>BUY GRID</td><td>SELL GRID</td><td colspan="2">LOT / GRID Controls</td></tr>
            <tr><td class="tag tag-buy">BUY 1x</td><td class="tag tag-sell">SELL 1x</td><td colspan="2"></td></tr>
        </table>
    </div>

    <div class="card">
        <h3>Signal Panel</h3>
        <p>Panel sinyal HTF menampilkan data dari 5 timeframe dalam bentuk tabel:</p>
        <table>
            <tr><th></th><th>M15</th><th>M30</th><th>H1</th><th>H4</th><th>D1</th></tr>
            <tr><td><strong>SnR</strong></td><td>Buy/Sell/Net/Break/Ret</td><td colspan="4">Status posisi relatif terhadap S/R level</td></tr>
            <tr><td><strong>RSI</strong></td><td>0-100</td><td colspan="4">Nilai RSI dengan warna (Lime=Oversold, Red=Overbought)</td></tr>
            <tr><td><strong>Div</strong></td><td>Bull/Bear/Net</td><td colspan="4">Status divergence</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>Lot & Grid Controls</h3>
        <ul>
            <li><strong>Lot Control:</strong> [-] [Edit Box] [+] - Adjust lot size dengan step sesuai broker</li>
            <li><strong>Grid Control:</strong> [-] [Edit Box] [+] pips - Adjust grid step (dalam Pips, dikonversi ke Points)</li>
        </ul>
    </div>
</section>

<!-- TRADING FUNCTIONS -->
<section id="trading">
    <h2>üíπ Trading Functions</h2>
    
    <div class="grid">
        <div class="card">
            <h3>OpenSingleOrder()</h3>
            <p>Membuka order market tunggal:</p>
            <ul>
                <li>Menggunakan <code>CurrentLot</code></li>
                <li>Comment: "SETAN V2"</li>
                <li>Tanpa SL/TP awal</li>
            </ul>
        </div>

        <div class="card">
            <h3>OpenGridOrders()</h3>
            <p>Membuka grid orders dengan pending:</p>
            <ul>
                <li>Layer pertama: Market order</li>
                <li>Layer berikutnya: BuyLimit/SellLimit atau BuyStop/SellStop</li>
                <li>Jarak: <code>CurrentGridStep</code> (points)</li>
                <li>Martingale: Lot += <code>InpLotIncrement</code> per layer</li>
            </ul>
        </div>

        <div class="card">
            <h3>PartialClose()</h3>
            <p>Partial close posisi:</p>
            <ul>
                <li><code>profitOnly=true</code>: Close hanya posisi profit</li>
                <li><code>profitOnly=false</code>: Close hanya posisi loss</li>
                <li>Close volume: <code>InpPartialPercent</code>% dari volume</li>
            </ul>
        </div>

        <div class="card">
            <h3>ApplySL() / ApplyTP()</h3>
            <p>Aplikasi SL/TP ke semua posisi:</p>
            <ul>
                <li><strong>AUTO_ATR_SNR:</strong> SL = Open ¬± (ATR √ó Multiplier), TP = SnR level terdekat</li>
                <li><strong>FIXED:</strong> SL/TP = Fixed points dari input</li>
            </ul>
        </div>

        <div class="card">
            <h3>SetBreakEven()</h3>
            <p>Set break even untuk posisi profit:</p>
            <ul>
                <li>NewSL = OpenPrice + <code>InpBE_Lock</code> (Buy)</li>
                <li>NewSL = OpenPrice - <code>InpBE_Lock</code> (Sell)</li>
                <li>Hanya update jika SL baru lebih baik</li>
            </ul>
        </div>

        <div class="card">
            <h3>Close Functions</h3>
            <ul>
                <li><code>CloseAllPositions()</code> - Close semua posisi symbol</li>
                <li><code>ClosePositionsByType()</code> - Close by position type</li>
                <li><code>DeleteAllPendingOrders()</code> - Delete semua pending</li>
            </ul>
        </div>
    </div>
</section>

<!-- SIGNAL GENERATOR -->
<section id="signals">
    <h2>üì° Signal Generator</h2>
    
    <div class="card">
        <h3>Scoring System</h3>
        <p>Signal dihasilkan berdasarkan akumulasi skor dari berbagai kondisi. Minimum score: <strong>5</strong></p>
        
        <table>
            <tr><th>Kondisi</th><th>Buy Score</th><th>Sell Score</th></tr>
            <tr><td>MA Crossover / Trend Change</td><td>+2</td><td>+2</td></tr>
            <tr><td>DI Crossover (dengan ADX Strong)</td><td>+2</td><td>+2</td></tr>
            <tr><td>ADX Direction (DI+>DI- atau sebaliknya)</td><td>+1</td><td>+1</td></tr>
            <tr><td>At Support / Break Resistance</td><td>+2</td><td>-</td></tr>
            <tr><td>At Resistance / Break Support</td><td>-</td><td>+2</td></tr>
            <tr><td>RSI Oversold</td><td>+1</td><td>-</td></tr>
            <tr><td>RSI Overbought</td><td>-</td><td>+1</td></tr>
            <tr><td>Bullish Engulfing</td><td>+2</td><td>-</td></tr>
            <tr><td>Bearish Engulfing</td><td>-</td><td>+2</td></tr>
            <tr><td>At Swing Low</td><td>+1</td><td>-</td></tr>
            <tr><td>At Swing High</td><td>-</td><td>+1</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>Signal Output</h3>
        <ul>
            <li>Jika <code>buyScore >= 5</code> dan <code>buyScore > sellScore</code> ‚Üí <span class="tag tag-buy">BUY SIGNAL</span></li>
            <li>Jika <code>sellScore >= 5</code> dan <code>sellScore > buyScore</code> ‚Üí <span class="tag tag-sell">SELL SIGNAL</span></li>
            <li>Arrow digambar di chart dengan label score</li>
            <li>Alert popup jika <code>InpSignalAlert=true</code></li>
        </ul>
    </div>

    <div class="card">
        <h3>Historical Signal Scan</h3>
        <p><code>ScanHistoricalSignals()</code> memindai 500 bar terakhir saat init untuk menampilkan sinyal historis (non-repainting).</p>
    </div>
</section>

<!-- S/R LEVELS -->
<section id="snr">
    <h2>üìç Support & Resistance</h2>
    
    <div class="card">
        <h3>Pivot Detection</h3>
        <ul>
            <li><strong>Pivot High:</strong> Bar dengan High tertinggi dalam range ¬±<code>SnR_Pivot_Period</code></li>
            <li><strong>Pivot Low:</strong> Bar dengan Low terendah dalam range ¬±<code>SnR_Pivot_Period</code></li>
            <li>Preload dari <code>SnR_Look_Back</code> bar saat init</li>
        </ul>
    </div>

    <div class="card">
        <h3>S/R Zone Calculation</h3>
        <p><code>CalculateSRZones()</code> mengelompokkan pivot points yang berdekatan:</p>
        <ol>
            <li>Hitung <code>cwidth</code> = 10% dari range high-low 300 bar</li>
            <li>Groupkan pivots dengan jarak < cwidth</li>
            <li>Hitung rata-rata weighted untuk level zone</li>
            <li>Sort by strength (jumlah pivots dalam zone)</li>
            <li>Ambil top N level (max: <code>SnR_Max_Levels</code>)</li>
        </ol>
    </div>

    <div class="card">
        <h3>SnR Status</h3>
        <table>
            <tr><th>Status</th><th>Kondisi</th><th>Return</th></tr>
            <tr><td>Breakout</td><td>Body candle cross level</td><td>3</td></tr>
            <tr><td>Retest</td><td>Wick cross, body safe</td><td>4</td></tr>
            <tr><td>At Support (Buy)</td><td>Close > level, jarak <= proximity</td><td>1</td></tr>
            <tr><td>At Resistance (Sell)</td><td>Close < level, jarak <= proximity</td><td>2</td></tr>
            <tr><td>Neutral</td><td>Tidak ada kondisi terpenuhi</td><td>0</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>S/R Line Display</h3>
        <p>Garis S/R ditampilkan dengan label yang menunjukkan:</p>
        <ul>
            <li>Price level</li>
            <li>Persentase jarak dari harga saat ini</li>
            <li>Jumlah Breakouts (B) dan Retests (R)</li>
        </ul>
        <p>Format: <code>1.2345 (+0.5%) [B:3|R:5]</code></p>
    </div>
</section>

<!-- DIVERGENCE -->
<section id="divergence">
    <h2>üîÄ RSI Divergence Detection</h2>
    
    <div class="card">
        <h3>Detection Logic</h3>
        <table>
            <tr><th>Type</th><th>Price</th><th>RSI</th><th>Signal</th></tr>
            <tr><td class="tag tag-buy">Bullish Divergence</td><td>Lower Low</td><td>Higher Low</td><td>Potential reversal UP</td></tr>
            <tr><td class="tag tag-sell">Bearish Divergence</td><td>Higher High</td><td>Lower High</td><td>Potential reversal DOWN</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>Implementation</h3>
        <ol>
            <li><code>ScanDivergence()</code> memindai RSI pivots pada HTF yang dipilih</li>
            <li>Pivot RSI dideteksi dengan left/right period = 5 bars</li>
            <li>Price pivot dicari dalam range ¬±3 bar dari RSI pivot</li>
            <li>Jika kondisi divergence terpenuhi, garis dan label digambar</li>
            <li>Duplicate detection mencegah divergence yang sama digambar ulang</li>
        </ol>
    </div>

    <div class="card">
        <h3>Visual Elements</h3>
        <ul>
            <li><strong>Trend Line:</strong> Menghubungkan dua pivot points</li>
            <li><strong>Label:</strong> "Bull" atau "Bear" di ujung garis</li>
            <li>Warna sesuai <code>InpDivBullColor</code> / <code>InpDivBearColor</code></li>
        </ul>
    </div>
</section>

<!-- NEWS FILTER -->
<section id="news">
    <h2>üì∞ News Filter System</h2>
    
    <div class="card">
        <h3>Currency Detection</h3>
        <p><code>GetCurrenciesFromSymbol()</code> mengekstrak mata uang dari symbol:</p>
        <ul>
            <li><strong>Forex:</strong> EURUSD ‚Üí EUR, USD</li>
            <li><strong>Gold:</strong> XAUUSD ‚Üí XAU, USD, EUR</li>
            <li><strong>Silver:</strong> XAGUSD ‚Üí XAG, USD</li>
            <li><strong>Oil:</strong> USOIL ‚Üí USD, CAD</li>
            <li><strong>Crypto:</strong> BTCUSD ‚Üí USD</li>
        </ul>
    </div>

    <div class="card">
        <h3>MQL5 Calendar Integration</h3>
        <p><code>FetchNewsEvents()</code> menggunakan MQL5 Calendar API:</p>
        <ul>
            <li><code>CalendarValueHistory()</code> - Fetch events dalam range waktu</li>
            <li><code>CalendarEventById()</code> - Get event details</li>
            <li><code>CalendarCountryById()</code> - Get country/currency info</li>
            <li>Update interval: 5 menit</li>
        </ul>
    </div>

    <div class="card">
        <h3>News Panel Display</h3>
        <p>Menampilkan hingga 8 event berita dengan:</p>
        <ul>
            <li>üî¥üü†üü° Impact icon berdasarkan level</li>
            <li>Time remaining (in Xm / -Xm ago)</li>
            <li>Currency code</li>
            <li>Event name (truncated 35 chars)</li>
        </ul>
    </div>

    <div class="card">
        <h3>News Alert</h3>
        <p>Alert popup untuk berita High Impact:</p>
        <ul>
            <li>Trigger: <code>InpNewsAlertMinutes</code> sebelum event</li>
            <li>Cooldown: 5 menit antara alerts</li>
            <li>Format: "‚ö†Ô∏è HIGH IMPACT NEWS in X minutes!"</li>
        </ul>
    </div>
</section>

<!-- FUNCTIONS REFERENCE -->
<section id="functions">
    <h2>üîß Functions Reference</h2>
    
    <div class="card">
        <h3>Core Event Handlers</h3>
        <table>
            <tr><th>Function</th><th>Deskripsi</th></tr>
            <tr><td><code>OnInit()</code></td><td>Inisialisasi EA, create indicators, panel, news system</td></tr>
            <tr><td><code>OnDeinit()</code></td><td>Cleanup semua handles dan objects</td></tr>
            <tr><td><code>OnTick()</code></td><td>Update timer, signals (on new bar), news (every 5 min)</td></tr>
            <tr><td><code>OnChartEvent()</code></td><td>Handle button clicks dan edit box input</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>UI Functions</h3>
        <table>
            <tr><th>Function</th><th>Deskripsi</th></tr>
            <tr><td><code>CreatePanel()</code></td><td>Create main trading panel</td></tr>
            <tr><td><code>CreateSignalPanel()</code></td><td>Create HTF signal display panel</td></tr>
            <tr><td><code>CreateButton()</code></td><td>Helper: Create styled button</td></tr>
            <tr><td><code>CreateLabel()</code></td><td>Helper: Create styled label</td></tr>
            <tr><td><code>CreateLotGridControl()</code></td><td>Create lot/grid input controls</td></tr>
            <tr><td><code>CreateWatermark()</code></td><td>Create EA watermark label</td></tr>
            <tr><td><code>DarkenColor()</code></td><td>Helper: Darken color by percentage</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>Signal Functions</h3>
        <table>
            <tr><th>Function</th><th>Deskripsi</th></tr>
            <tr><td><code>UpdateSignals()</code></td><td>Update semua HTF signal displays</td></tr>
            <tr><td><code>CheckSignalConditions()</code></td><td>Evaluate semua kondisi sinyal</td></tr>
            <tr><td><code>GenerateSignal()</code></td><td>Calculate score dan generate signal</td></tr>
            <tr><td><code>DrawSignalArrow()</code></td><td>Draw arrow dan label di chart</td></tr>
            <tr><td><code>UpdateSignalDisplay()</code></td><td>Update panel signal display</td></tr>
            <tr><td><code>ScanHistoricalSignals()</code></td><td>Scan dan draw historical signals</td></tr>
            <tr><td><code>CheckEngulfingPattern()</code></td><td>Check bullish/bearish engulfing</td></tr>
            <tr><td><code>CheckSwingHL()</code></td><td>Check if at swing high/low</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>S/R Functions</h3>
        <table>
            <tr><th>Function</th><th>Deskripsi</th></tr>
            <tr><td><code>UpdateSRLevels()</code></td><td>Update S/R levels untuk SnRData</td></tr>
            <tr><td><code>DetectPivotHigh()</code></td><td>Detect pivot high at timeframe</td></tr>
            <tr><td><code>DetectPivotLow()</code></td><td>Detect pivot low at timeframe</td></tr>
            <tr><td><code>PreloadPivots()</code></td><td>Preload historical pivots</td></tr>
            <tr><td><code>CalculateSRZones()</code></td><td>Calculate S/R zones from pivots</td></tr>
            <tr><td><code>GetLevelCounts()</code></td><td>Count breakouts dan retests</td></tr>
            <tr><td><code>DrawSRLines()</code></td><td>Draw S/R lines dan labels</td></tr>
            <tr><td><code>GetSnRStatus()</code></td><td>Get current SnR status</td></tr>
            <tr><td><code>UpdateSingleSnR()</code></td><td>Update single SnR label</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>Trend MA Functions</h3>
        <table>
            <tr><th>Function</th><th>Deskripsi</th></tr>
            <tr><td><code>DrawTrendMALines()</code></td><td>Draw MA lines dengan warna dinamis</td></tr>
            <tr><td><code>DrawMASegmentAtBar()</code></td><td>Draw single MA segment</td></tr>
            <tr><td><code>DrawTrendSegment()</code></td><td>Create/update trend line object</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>Divergence Functions</h3>
        <table>
            <tr><th>Function</th><th>Deskripsi</th></tr>
            <tr><td><code>ScanDivergence()</code></td><td>Main divergence scan function</td></tr>
            <tr><td><code>DetectRSIPivotsAndDiv()</code></td><td>Detect RSI pivots dan check divergence</td></tr>
            <tr><td><code>StoreAndCheckDiv()</code></td><td>Store pivot dan check for divergence</td></tr>
            <tr><td><code>DrawDivOnChart()</code></td><td>Draw divergence line dan label</td></tr>
            <tr><td><code>IsDivDrawn()</code></td><td>Check if divergence already drawn</td></tr>
            <tr><td><code>RecordDiv()</code></td><td>Record drawn divergence</td></tr>
            <tr><td><code>TimeDifferenceBars()</code></td><td>Calculate bar difference between times</td></tr>
            <tr><td><code>GetDivergenceStatus()</code></td><td>Get divergence status for panel</td></tr>
            <tr><td><code>UpdateSingleDivergence()</code></td><td>Update single divergence label</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>News Functions</h3>
        <table>
            <tr><th>Function</th><th>Deskripsi</th></tr>
            <tr><td><code>InitializeNews()</code></td><td>Initialize news system</td></tr>
            <tr><td><code>GetCurrenciesFromSymbol()</code></td><td>Extract currencies from symbol</td></tr>
            <tr><td><code>IsRelatedCurrency()</code></td><td>Check if currency is relevant</td></tr>
            <tr><td><code>FetchNewsEvents()</code></td><td>Fetch from MQL5 Calendar</td></tr>
            <tr><td><code>SortNewsByTime()</code></td><td>Sort events by time</td></tr>
            <tr><td><code>ConvertImpact()</code></td><td>Convert calendar importance to enum</td></tr>
            <tr><td><code>CreateNewsPanel()</code></td><td>Create news panel UI</td></tr>
            <tr><td><code>UpdateNewsDisplay()</code></td><td>Update news items display</td></tr>
            <tr><td><code>CheckNewsAlerts()</code></td><td>Check and trigger news alerts</td></tr>
            <tr><td><code>CleanupNews()</code></td><td>Delete news objects</td></tr>
            <tr><td><code>GetImpactColor()</code></td><td>Get color by impact level</td></tr>
            <tr><td><code>GetImpactIcon()</code></td><td>Get emoji icon by impact</td></tr>
            <tr><td><code>FormatTimeRemaining()</code></td><td>Format time until/since event</td></tr>
        </table>
    </div>

    <div class="card">
        <h3>Utility Functions</h3>
        <table>
            <tr><th>Function</th><th>Deskripsi</th></tr>
            <tr><td><code>GetATR()</code></td><td>Get current ATR value</td></tr>
            <tr><td><code>GetStrongestSnRLevel()</code></td><td>Get nearest S/R for TP</td></tr>
            <tr><td><code>GetTFIndex()</code></td><td>Get index dari tfList array</td></tr>
            <tr><td><code>GetActualHTF()</code></td><td>Resolve PERIOD_CURRENT</td></tr>
            <tr><td><code>GetHTFName()</code></td><td>Get HTF name string</td></tr>
            <tr><td><code>UpdateCandleTimer()</code></td><td>Update candle countdown timer</td></tr>
            <tr><td><code>UpdateLotDisplay()</code></td><td>Update lot edit box</td></tr>
            <tr><td><code>UpdateGridDisplay()</code></td><td>Update grid edit box</td></tr>
            <tr><td><code>AdjustLot()</code></td><td>Adjust lot by step</td></tr>
            <tr><td><code>AdjustGrid()</code></td><td>Adjust grid by pips</td></tr>
            <tr><td><code>SetupChartAppearance()</code></td><td>Configure chart colors/appearance</td></tr>
        </table>
    </div>
</section>

<footer style="text-align:center; padding:40px; color:var(--text-muted); border-top:1px solid var(--border); margin-top:40px;">
    <p>‚óÜ TUYUL BIRU V2.0 Documentation ‚óÜ</p>
    <p>Generated: 2026-01-01 | Total Lines: 3408 | File Size: ~126KB</p>
</footer>

</div>
</body>
</html>
